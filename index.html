<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SDS - Scripts Delivery System</title>
    <style>
        :root { --neon: #00f2ff; --bg: #050505; --card: #121212; }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: var(--bg); color: #fff; display: flex; align-items: center; justify-content: center; min-height: 100vh; }
        
        .container { background: var(--card); padding: 30px; border-radius: 20px; border: 1px solid #333; box-shadow: 0 0 25px rgba(0, 242, 255, 0.1); width: 100%; max-width: 450px; text-align: center; }
        h2 { color: var(--neon); text-shadow: 0 0 10px var(--neon); margin-bottom: 20px; }
        
        input { width: 100%; padding: 12px; margin: 10px 0; background: #1a1a1a; border: 1px solid #333; color: #fff; border-radius: 8px; box-sizing: border-box; }
        input:focus { border-color: var(--neon); outline: none; box-shadow: 0 0 5px var(--neon); }
        
        button { width: 100%; padding: 12px; background: var(--neon); color: #000; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; margin-top: 10px; transition: 0.3s; }
        button:hover { opacity: 0.8; transform: scale(1.02); }

        .toggle-link { color: #888; font-size: 13px; cursor: pointer; display: block; margin-top: 15px; }
        .toggle-link b { color: var(--neon); }

        #main-app { display: none; width: 90%; max-width: 800px; }
        #output { background: #000; color: #0f0; padding: 15px; border-radius: 8px; text-align: left; min-height: 150px; white-space: pre-wrap; font-family: monospace; border: 1px solid #222; margin-top: 20px; }
    </style>
</head>
<body>

    <div class="container" id="auth-box">
        <div id="login-form">
            <h2>SDS LOGIN</h2>
            <input type="text" id="log-user" placeholder="اسم المستخدم">
            <input type="password" id="log-pass" placeholder="كلمة المرور">
            <button onclick="handleLogin()">تسجيل الدخول</button>
            <span class="toggle-link" onclick="toggleAuth()">ليس لديك حساب؟ <b>إنشاء حساب جديد</b></span>
        </div>

        <div id="signup-form" style="display: none;">
            <h2>CREATE ACCOUNT</h2>
            <input type="text" id="reg-user" placeholder="اختر اسم مستخدم">
            <input type="password" id="reg-pass" placeholder="اختر كلمة مرور">
            <button onclick="handleSignup()">إنشاء الحساب</button>
            <span class="toggle-link" onclick="toggleAuth()">لديك حساب بالفعل؟ <b>دخول</b></span>
        </div>
    </div>

    <div id="main-app">
        <div class="container" style="max-width: 100%;">
            <div style="display:flex; justify-content: space-between; align-items: center;">
                <h2 style="margin:0;">SDS GENERATOR</h2>
                <button onclick="location.reload()" style="width: auto; padding: 5px 15px; background: #ff4444; color: white;">خروج</button>
            </div>
            <hr style="border: 0.5px solid #222; margin: 20px 0;">
            <input type="text" id="prompt" placeholder="اطلب سكربت اللعبة هنا (مثلاً: Fly Script Roblox)">
            <button id="genBtn" onclick="generateScript()">توليد السكربت</button>
            <div id="output">بانتظار أوامرك...</div>
        </div>
    </div>

    <script type="importmap">
      { "imports": { "@google/generative-ai": "https://esm.run/@google/generative-ai" } }
    </script>

    <script type="module">
        import { GoogleGenerativeAI } from "@google/generative-ai";

        // --- نظام الحسابات ---
        window.toggleAuth = () => {
            const loginF = document.getElementById('login-form');
            const signupF = document.getElementById('signup-form');
            loginF.style.display = loginF.style.display === 'none' ? 'block' : 'none';
            signupF.style.display = signupF.style.display === 'none' ? 'block' : 'none';
        }

        window.handleSignup = () => {
            const user = document.getElementById('reg-user').value;
            const pass = document.getElementById('reg-pass').value;
            if(!user || !pass) return alert("املاً البيانات!");
            
            localStorage.setItem(`sds_user_${user}`, pass);
            alert("تم إنشاء الحساب بنجاح! يمكنك الآن تسجيل الدخول.");
            toggleAuth();
        }

        window.handleLogin = () => {
            const user = document.getElementById('log-user').value;
            const pass = document.getElementById('log-pass').value;
            const savedPass = localStorage.getItem(`sds_user_${user}`);

            if(savedPass && savedPass === pass) {
                document.getElementById('auth-box').style.display = 'none';
                document.getElementById('main-app').style.display = 'block';
            } else {
                alert("اسم المستخدم أو كلمة المرور غير صحيحة!");
            }
        }

        // --- نظام الذكاء الاصطناعي ---
        window.generateScript = async () => {
            const prompt = document.getElementById('prompt').value;
            const output = document.getElementById('output');
            const btn = document.getElementById('genBtn');
            
            if(!prompt) return alert("اكتب طلبك أولاً!");

            const API_KEY = "AIzaSyCMp7fZrKKC-mweC6Qm7_xaIJXpKXq-e9E";
            const genAI = new GoogleGenerativeAI(API_KEY);
            const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });

            btn.disabled = true;
            output.innerText = "⏳ جاري توليد السكربت... يرجى الانتظار";

            try {
                const result = await model.generateContent("أعطني سكربت لـ: " + prompt + " مع شرح بسيط جداً بالعربية.");
                output.innerText = result.response.text();
            } catch (e) {
                output.innerText = "❌ حدث خطأ في النظام. تأكد من إعدادات الـ API.";
            } finally {
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>
